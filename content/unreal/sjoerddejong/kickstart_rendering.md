---
title: "Unreal Kickstart - Rendering"
author: ["Sjoerd De Jong", "Mario Palmero"]
categories: ["Unreal", "Sjoerd De Jong"]
date: 2022-04-26T17:40:24+09:00
weight: 1


# searchHidden: true

#cover:
#    image: "<image path/url>"    # can also paste direct link from external site
#    alt: "<alt text>"
#    caption: "<text>"
#    relative: false 	# To use relative path for cover image, used in hugo Page-bundles

#ShowBreadCrumbs: false
---


# Intro and Philosophy

## History
- rendering has always been focus point
- **best visual** at the **best performance**
- **all-compatible set of tools** for any renderer or platform

### UE1 (1997)
- blended colored light
- dynamic, static light
- volumetric light, lensflare, perfect mirrors, procedural texture effects
- 1k, 2k supported, detailed texture in 256mb memory

### UE2 (2002)
- DirectX 7 support
- mesh, terrains, larger outdoor environments, vehicles
- foliage and particle
- basic material
- vertex lighting

### UE3 (2006)
- DirectX 9 support
- forward rendering
- even larger outdoor environments
- full lightmapping, dynamic shadows

### UE4 (2014)
- handle any style (not only high realism)
- scalabiliy, from indipendable to AAA
- over game egine
  - better fidelity, architecture, pipeline, flexibility

### UE5 (2022)
- Nanite
- Lumen
- Niagara

## Schematic Schematic
1. Ahead of Rendering
2. Visibility Features
3. Start of Rendering
4. BasePass
   - BasePass Material
     - Geometry
	 - Precomputed Lighting
5. GBuffer
6. Dynamic Light & Shadow
7. Reflections
8. Additional
   - Translucency
   - Atmospherics
   - Etc
9. Post Processing
10. Final Frame
    - Scalability and Performance


# Schematic Overview

![image](../rendering_18x24.png)    
[Full size (4MB)](../rendering_poster.png)    

## Ahead of Rendering (Frame 0, CPU)

### All Logic
> deciding what to render    
- Gameplay
- Animation
- Physics
- etc..

### Visibility (Frame 1, CPU)
> check what can be seen by camera.    
> process lighter tasks first to reduce calcuration candidates    
- Occlusion/Visibility Processes
  1. Distance Culling (Lightest)
     - not enabled by default (recommended)
     - by `CullDistanceVolume`
	   - or you have to set Desired Max Draw Distance for every actors (annoying)
  2. Frustum Culling
     - standard enabled
	 - why you have to disable this?
  3. Precomputed Visibility
     - not enabled by default (optional)
     - enable with World Setting property
     - Good for space-time tradeoff
	   - use memmory to reduce cpu cost
     - by `PrecomputedVisibilityVolume`
  4. Visibility Culling (Heaviest)
     - standard enabled
     - heavy
     - check with `freezerendering`
     - Hardware Occlusion
       - use every mesh as occluder
  	   - not work in every devices (so engine need Software Occlusion)
     - Software Occlusion
       - uses Mesh LODs as occluder

## Start of Rendering (Frame 2, GPU)

### Early Z Pass
- Scene Depth
- used for deferred rendering pipeline

### Basepass
> Act of rendering all geometries    
> can check with GPU compiler    
- Drawcalls
  - HLOD
  - Static Meshes
  - Instanced Meshes
  - Skeletal Meshes
  - Landscapes
  - Procedural Meshes
  - Geometry Collection
  - ... etc (Geometry, 3D to render)
- Dynamic Instancing
  > automatically batch drawcalls    
  - enabled by default
  - same mesh, same material in one drawcall
- Basspass Materials
  > unreal's deferred rendering do not render every materials at once.    
  > first, basic materials are rendered here (without shadow, blending, etc)    
  - Lightmaps
	- need for initial shading
    - Generated by Lightmass

### Static Lighting/Shadows
- Lightmass
  > Separeted application run by Swarm agent    
  > manage building and baking lights    
  - what
    - Static Light Actors placed in the world
    - Lightmass Importance Volume
    - Global Illumination/Radiosity
  - how
    - Volumetric Lightmaps
	  - default setting for current version
	  - saves lighting data since lightmap doesn't provide dynamic lighitng data
	- Volume Lighting Samples
	  - used for older version
	  - less memory, less gpu time, less accuracy
	  - saves single color only for dynamic lighting data

### GBuffer
- Buffer A : World Normals
- Buffer B : Specular / Roughness / Metalic
- Buffer C : Base Color / Lighting
- Buffer D : Additional
- Buffer E : Additional

### Dyanmic Lighting/Shadows

#### Direct-Light
- IES Profiles
  - customize light projection and intensity
  - can be static
- Light Functions
  - Material -> Material Domain -> Light Function
  - e.g. fire flickering, water caustics, cloud shadow
  - kinda heavy work, so set Fade Distance in proper value

#### Direct-Shadow
- Dynamic Shadows
  - optionally use `Mesh Distance Field`
  - cached (performance dip when invalidated)
  - `r.Shadow.CacheWholeSceneShadows`
- Cascaded Shadow Maps
  - for gradually disappearing shadows
  - low, medium, high quality (3 by default)
  - commonly used in directional light, outdoor environments
  - still heavy, ugly when shadow disappear -> Distance Field Shadows
- Distance Field Shadow
  - not enabled by default
  - uses `Mesh Distance Field`
  - need more memory and imprecise
- Raytraced Shadows
- Per Object Shdows & Inset Shadows
  - used for often-seen shadows (like character mesh)
  - can show more precise shadow
- Contact Shadows
  - shadow over close obejcts
  - kind of post processing
  - for tiny detail

#### Indirect-Light
> both are not commonly used for nowdays    
- Light Propagation
  - older realtime GI
  - outdated; not recommended
- Raytraced GI
  - complication of raytracing feature
  - complex works

#### Indirect-Sahdow
- Raycast AO
  - raycast feature
  - Accurate raytraced Ambient Occlusion (a.k.a. its name)
- Capsule Shadow
  - simplicating skeletal mesh shadows
  - commonly used for tiny creatures or massive characters
  - can be used for vague light art style
- DFAO
  - Distance Field Ambient Occlusion
  - uses `Mesh Distance Field`
  - used for moveable. stationary Skylight (in detail panel)
  - let actor scale stay close to 1, or Distance Field will look weird

### Reflections

### Additional

### Post Processing

## Final Frame (Frame N, )

### Performance

### Scalability Example



Plugin : RenderDoc
- data, 



# Advice

 